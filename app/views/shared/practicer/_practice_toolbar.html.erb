<% extended = false if local_assigns[:extended].nil? %>
<%= turbo_frame_tag "#{extended ? 'extended_' : 'non_extended_'}practice_toolbar_#{exercise.id}" do %>
  <nav class="md:flex md:space-x-4">

    <% if extended %>
      <div class="flex-1 flex-shrink-0 min-w-0">
        <label class="block mb-2">Temps de pratique:</label>
        <input type="time" class="block px-3 py-2 w-full placeholder-gray-400 text-black rounded-md border border-gray-300 shadow-sm appearance-none focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"
        data-practices-target="selectedTime" value="<%= exercise.duration ? Time.at(exercise.duration).utc.strftime("%H:%M") : "00:10" %>"/>
      </div>
    <% end %>

    <div class="flex self-center space-x-4 md:w-6/12">
      <!-- ADD TO PRACTICE -->
      <%= link_to add_to_practice_exercises_url(id: exercise.id), data: {practices_target: 'practiceLink'} do %>
        <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M9 13h6m-3-3v6m5 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
        </svg> <%= "Ajouter Ã  ma pratique du jour" if extended %>
      <% end %>

      <!-- FAVORITES ADD/REMOVE -->
      <%
        action = (current_user.favorites.include? exercise.id.to_s) ? 'remove' : 'add'
        label = "#{(action == 'remove') ? 'Retirer' : 'Ajouter'} de mes favoris"
        link = add_or_remove_favorite_exercises_url(id: exercise.id, add_or_remove: action)
        icon = if action == 'add'
                '<svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z" />
                </svg>'
              else
                '<svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z" />
                </svg>'
              end
      %>

      <%= link_to link do %>
          <%= raw icon %> <%= label if extended %>
      <% end %>
    </div>
  </nav>
<% end %>
